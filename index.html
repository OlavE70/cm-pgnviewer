<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Stylesheet für cm-chessboard -->
  <link rel="stylesheet" href="/cm-chessboard-assets/chessboard.css">
  <link rel="stylesheet" href="/cm-chessboard-assets/extensions/promotion-dialog/promotion-dialog.css">
  <link rel="stylesheet" href="cm-pgnviewer.css">
  <!-- FontAwesome 5 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <style>
    /* Responsive Container: Gilt standardmäßig für alle Bildschirmgrößen */
    .responsive-container {
        margin-left: auto;
        margin-right: auto;
        max-width: 1000px; /* Standard: Begrenzt auf breitere Bildschirme */
        width: 95%; /* Hält 95% der Breite, um Ränder zu lassen */
        padding: 0 1rem;
    }

    /* Anpassung für Smartphones (max. 550px Breite) */
    @media (max-width: 550px) {
        .responsive-container {
            max-width: 100%; /* Erlaubt volle Breite auf kleinen Geräten */
            width: 100%;
            padding: 0 0.5rem; /* Reduziert die horizontalen Ränder */
        }
    }
  </style>
  <title>PGN Viewer Demo</title>
</head>
<body>
  <h1>PGN Viewer Demo (neuer Wrapper + Viewer mit Adapter)</h1>
  <h2>Kommentiertes Spiel</h2>
  <div class="responsive-container">
    <pgn>
      [Event "Monte Carlo"]
      [Site "Monte Carlo MNC"]
      [Date "1968.??.??"]
      [Round "8"]
      [White "Larsen, Bent"]
      [Black "Gheorghiu, Florin"]
      [Result "1-0"]
      [ECO "A20"]
      [Annotator "Oli1970"]
      [AnnotationDate "2021.??.??"]
      [Comment "Schwerfiguren haben es auch nicht leicht"]
      [Link "unveröffentlicht"]

      1.c4 e5 2.g3 g6 3.d4 exd4 4.Qxd4 Nf6 5.Nc3 Nc6 6.Qe3+ Be7 $6
      {Schwarz muss sich fragen lassen, warum er den Königsflügel öffnet, wenn er den Läufer nicht nach g7 fianchettiert.}
      ( 6...Qe7 {Evtl. die bessere Erwiderung. Weiß wählt dann voraussichtlich zwischen Entwicklung mit Lg2 oder Damentausch mit Dxe7 Lxe7.} )
      ( 6...Ne7 $2 {Verliert mindestens einen Bauern.} 7.Qe5 Bg7 8.Nd5 $1 Kf8
      ( 8...Nxd5 9.Qxg7 Rg8 10.Qd4 {denn Dxh7 Sb4! mit Drohung Sc2.} )
      ( 8...O-O $4 9.Nxe7+ )
      9.Qxc7 {denn Sxc7? d6!,} 9...Qxc7 10.Nxc7 )
      7.Nd5 Nxd5
      {Gheorghiu hatte hier bereits eine Stunde (!) Bedenkzeit verbraucht.}
      8.cxd5 Nb8
      ( {Die schlechtere Alternative wäre } 8...Nb4 9.Qc3 f6 {Die Drohung gegen Th8 kann nur durch Vorziehen des f6 pariert werden. O-O wird mit Lh6 und der Drohung Dg7# beantwortet.} )
      9.d6 $1
      {Da der Läufer gefesselt ist, kann Gheorghiu nur mit dem Bauern nehmen. Der Doppelbauer erschwert die Entwicklung des Damenflügels.}
      9...cxd6 10.Nh3 O-O 11.Qh6 Nc6 12.Ng5 Bxg5 13.Bxg5 f6 14.Bd2
      {Dorthin wegen Da5+ mit Wechsel der Initiative, Ld2 ist die beste Verteidigung.}
      14...b6
      {Notwendig, um den Läufer in Bewegung zu bekommen, dafür hat die Dame keinen direkten Weg ins Feld mehr.}
      15.Bg2 Bb7
      ( {Nicht unbedingt stärker, aber ebenso spielbar, ist} 15...Ba6 {mit der Möglichkeit De7 und der Drohung De2#.} 16.Bd5+ Kh8 17.Bc3 Rc8 {Um Se5 zur Unterbrechung der Läuferdiagonale spielen zu können. Schwarz steht trotz Bauernrückstand recht solide, da Weiß zunächst neue Angriffsideen entwickeln muss. Dem Vorstoß h2-h4-h5 wird mit g6-g5 begegnet. Auf Df4 mit Zielen d6 und f6 folgt De7 oder Se5. O-O kostet e2.} )
      16.O-O Na5
      {Deckt natürlich Lb7, fordert jedoch auch den Abtausch des potentiell gefährlichen schwarzfeldrigen Läufers heraus.}
      17.Bxa5 Bxg2 18.Kxg2
      {Erzwungen wegen Lxf1.}
      18...bxa5
      {Die Leichtfiguren sind fort, aber zum Preis einer äußerst schwachen Bauernstruktur.}
      19.Rad1 Qe7 20.Rd2 Rab8 21.Rfd1 Qe4+
      {Das Zwischenschach verhindert Df4 und verschafft dadurch Zeit für Tb6. }
      22.Kg1 Rb6 23.h4
      ( 23.Rxd6 $2 Rxd6 24.Rxd6 {mit Remis wegen Dauerschach Db1 / De4.} )
      23...Qe5 24.b3
      {Wegen des Doppelangriffs auf b2.}
      24...Rc8 $2
      {In Zeitnot holt sich Gheorgiu die offene Linie. }
      ( 24...a4 $1 {Verpasst Larsen einen Doppelbauern und gibt Angriffschancen auf der b-Linie.} 25.bxa4 Rfb8 )
      ( 24...Rc6 $5 {Nun muss Weiß sorgfältig spielen und zunächst mit e2-e3 verhindern, dass Schwarz nach Tfc8 mit Dxe2 selbst einen Angriff erhält. Die Partiefortsetzung funktioniert so nicht:} 25.Rd5 Qxe2 26.h5 $2
      ( 26.Rxd6 Rxd6 27.Rxd6 {ergibt eine völlig ausgeglichene Stellung.} )
      26...g5 $1 $17 )
      25.Rd5 Qxe2 26.h5
      ( 26.Rxd6 $2 Rxd6 27.Rxd6 {mit Gewinnstellung für Schwarz!} )
      26...Rc2
      {Natürlich nicht g5 wegen Dxf6.}
      27.Rf1 Qe4 $2
      {Schwer zu sehen, warum dieser Zug ein Fehler ist. Bg6 wird gedeckt, die Dame steht zentral und greift den Turm an. Das Problem ist, dass die Dame in der Folge zum Ziel wird. Die Ausweichmanöver kosten Zeit, die Larsen für seinen Angriff nutzt.}
      ( 27...Qe8 {zieht die Dame in die Verteidigung zur Deckung von g6 zurück. } 28.hxg6
      ( {Unterschied zur Partiefortsetzung: } 28.Rxa5 d5 29.hxg6
      ( 29.Rxd5 g5 {mit schwarzem Vorteil.} )
      29...Qxg6 30.Qe3 )
      28...Qxg6 29.Qf4 Rxa2 )
      28.Rxa5 a6
      ( 28...Rc5 $5 {falls jetzt } 29.Rxa7 $4 Rxh5 {droht Dh1#. Weiß muss die Dame geben. } )
      29.Ra4 Qe8 30.Rg4
      {Larsen hat eine sehr starke Angriffsposition erspielt.}
      30...Qf8 31.Qe3
      ( 31.Rxg6+ {Eine alternative starke Kombination.} 31...hxg6 32.Qxg6+ Kh8 33.Qxc2 )
      31...Rbc6 $4
      {Dieser Zug verliert endgültig. Bf6-f5 oder Tb5 waren besser. Das folgende Muster ist aus den Varianten bekannt.}
      32.hxg6 hxg6 33.Rxg6+ Kf7 34.Rg4
      ( 34.Rh6 $3 {mit der Drohung Th7+ hat Larsen nicht genutzt.} 34...Qg7 35.Re1 {droht De8#.} )
      34...R2c5 35.Qd3
      {Wieder lange nicht so stark wie De4 mit der Drohung Dh7+.}
      35...Re5 36.f4 Re8 37.Qd5+
      {Larsen sah den stärkeren Gewinnweg nicht und geht daher auf Nummer sicher. Mit einer schönen Kombination hätte er Gheorgius Dame gewonnen, wenn dieser nicht einen Zug später aufgegeben hätte.}
      ( 37.Qh7+ $3 {drängt den König in die Brettmitte.} 37...Ke6
      ( 37...Qg7 38.Rxg7+ {Schwarz ist matt im nächsten Zug.} )
      38.f5+ Kd5 )
      37...Ke7 38.Re1+
      ( 38.Re1+ {Die Kombination zum Damengewinn:} 38...Kd8 39.Rxe8+ Qxe8 40.Rg8 Qxg8 41.Qxg8+ )
      1-0
    </pgn>
  </div>

  <!--
  <h2>Fehlerhaftes PGN</h2>
  <div class="responsive-container">
    <pgn>
      [Event "Beispielpartie 2"]
      [Site "Hamburg"]
      [Date "2023"]
      [White "Spieler C"]
      [Black "Spieler D"]
      [Result "0:1"]

      {Verkürzter Header, fehlerhaft Rochade mit 0-0 und Result mit 0:1 angegeben. Sichtbar ist die korrigierte Version.}
      1. d4 {Grandios eröffnet.} {Da bleibt dem Schwarzen nur} d5 {als Konter.} 2. c4! c6 3. Nc3 Nf6 4. Nf3 e6 5. Bg5 Nbd7 
      6. e3 Qa5 7. Nd2 Bb4 8. Qc2 0-0 9. Be2 dxc4 10. Nxc4 Qxg5 0:1
    </pgn>
  </div>

  <h2>Leeres PGN - keine Züge, nur Header</h2>
  <div class="responsive-container">
    <pgn>
      [Event "Beispielpartie 3"]
      [Site "München"]
      [Date "2023.07.03"]
      [Round "3"]
      [White "Spieler E"]
      [Black "Spieler F"]
      [Result "1/2-1/2"]
    </pgn>
  </div>

  <h2>Leere PGN-Tags</h2>
  <div class="responsive-container">
    <pgn> </pgn> 
  </div>  
  -->

  <h1>FEN / Schachkomposition</h1>
  <h2>FEN - ohne Zugvalidierung</h2>
  <div class="responsive-container">
    <fen author="Loyd, Samuel" source="New York Commercial Advertiser, 1897" stipulation="#2">3R3B/Q7/5nK1/3n4/3NkNR1/2p2p2/2P2P2/8</fen>
  </div>

  <h2>Board - mit Zugvalidierung</h2>
  <div class="responsive-container">
    <board author="Loyd, Samuel" source="New York Commercial Advertiser, 1897" stipulation="#2">3R3B/Q7/5nK1/3n4/3NkNR1/2p2p2/2P2P2/8</board>
  </div>

  <h2>Board - mit Promotion</h2>
  <div class="responsive-container">
    <board author="Testfall" source="unbekannt" stipulation="Promotion">4k3/1P6/8/8/6r1/8/8/2R1K3</board>
  </div>
  <!-- jQuery laden (wie auf Originalseite) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Neue Dateien -->
  <script type="module" src="./src/cm-pgnviewer.js"></script>
  <script type="module" src="./src/cm-pgnwrapper.js"></script>
  <script type ="module" src="./src/cm-pgnadapter.js"></script>

  <!-- Original-Initialisierung -->
  <script>
    document.createElement('pgn');
    document.createElement('fen');
    $(document).ready(function () {
      window.cmPgnViewer = new $.cmPgnViewer($("pgn"));
    });
  </script>
</body>
</html>
